using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using Proyecto26;
using <%= unity3dAppName %>GUI.Authentication.Model;

namespace <%= unity3dAppName %>GUI
{
    public static partial class <%= unity3dAppName %>App
    {
        public readonly static string BASE_PATH = "http://localhost:8080/";

        public static void LogMessage(string title, string message)
        {
            Debug.Log(message);
        }

        public static void authenticate(string username, string password) {
            RequestHelper requestOptions = new RequestHelper
            {
                Uri = BASE_PATH + "api/authenticate",
                Body = new AuthenticationToken
                {
                    username = username,
                    password = password
                },
            };

            RestClient.Post<Token>(requestOptions)
            .Then(response =>
            {
                RestClient.DefaultRequestHeaders["Authorization"] = $"Bearer {response.id_token}";
            })
            .Catch(err => LogMessage("Error", err.Message));
        }
    }
}